<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Sneaker Base | Premium Sneakers</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/static/style.css">

    <style>
        /* --- HEART BUTTON CSS --- */
        .fav-btn {
            position: absolute; 
            top: 10px; 
            right: 10px; 
            background: white; 
            border: none;
            border-radius: 50%; 
            width: 35px; 
            height: 35px; 
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2); 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            z-index: 10;
        }
        .fav-btn i { color: #ccc; font-size: 18px; transition: 0.2s; }
        .fav-btn.active i { color: red; } 

        /* Ensure the Product Card can hold the button */
        .product { 
            position: relative; 
            background: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            transition: 0.3s;
        }
        .product:hover { transform: translateY(-5px); }
        .product img { width: 100%; border-radius: 10px; }
        
        /* Dropdown CSS (just in case it's missing) */
        .dropdown { position: relative; display: inline-block; }
        .dropdown-content { display: none; position: absolute; background-color: white; min-width: 160px; box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2); z-index: 1; }
        .dropdown-content a { color: black; padding: 12px 16px; text-decoration: none; display: block; }
        .dropdown:hover .dropdown-content { display: block; }
    </style>
</head>
<body>
<header class="header">
    <div class="logo">
        <img src="/static/assets/images/logo.png" alt="Sneaker Base">
    </div>
    
    <nav class="nav-links">
        <a href="/">Home</a>
        <a href="/products">Men</a>
        <a href="/products">Women</a>
        <a href="/products">New In</a>
        
        <div class="dropdown">
            <a href="#" style="cursor: pointer;">Brands ▾</a>
            <div class="dropdown-content">
                <a href="/products?brand=Jordan">Air Jordan</a>
                <a href="/products?brand=Nike">Nike</a>
                <a href="/products?brand=Adidas">Adidas</a>
                <a href="/products?brand=Yeezy">Yeezy</a>
                <a href="/products">All Brands</a>
            </div>
        </div>
    </nav>

    <div class="icons" style="display: flex; align-items: center; gap: 20px;">
        <a href="/wishlist" title="My Wishlist" style="color: black; text-decoration: none;">
            <i class="fa fa-heart-o fa-2x"></i>
        </a>

        <a href="/cart" style="color: black; text-decoration: none;">
             <i class="fa fa-shopping-cart fa-2x"></i> 
             {% if cart_count and cart_count > 0 %}
             <span id="cart-count" style="background: black; color: white; border-radius: 50%; padding: 2px 6px; font-size: 12px; vertical-align: top;">{{ cart_count }}</span>
             {% endif %}
        </a>
    </div>
</header>

<section class="hero">
  <h1>Premium Sneakers</h1>
  <p>Limited Edition • Streetwear • Authentic</p>
  <button class="shop" onclick="window.location.href='/products'">Shop Now</button>
</section>

<section class="products">
  <h2>Popular Sneakers</h2>

  <div class="product-grid" id="product-grid">

    <div class="product">
        <button class="fav-btn" onclick="toggleHeart(this, 'Nike Air Jordan 1', '₹12,749', '/static/assets/images/image_a2edb9.png')">
            <i class="fa fa-heart"></i>
        </button>
        <a href="/products" style="text-decoration: none; color: inherit;">
            <img src="/static/assets/images/image_a2edb9.png" alt="Jordan 1">
            <h3>Nike Air Jordan 1</h3>
            <p>₹12,749</p>
        </a>
    </div>

    <div class="product">
        <button class="fav-btn" onclick="toggleHeart(this, 'Nike Vomero Plus', '₹15,295', '/static/assets/images/image_971f9c.jpg')">
            <i class="fa fa-heart"></i>
        </button>
        <a href="/products" style="text-decoration: none; color: inherit;">
            <img src="/static/assets/images/image_971f9c.jpg" alt="Vomero">
            <h3>Nike Vomero Plus</h3>
            <p>₹15,295</p>
        </a>
    </div>

    <div class="product">
        <button class="fav-btn" onclick="toggleHeart(this, 'Nike Baseball Cleats', '₹6,399', '/static/assets/images/image_971833.png')">
            <i class="fa fa-heart"></i>
        </button>
        <a href="/products" style="text-decoration: none; color: inherit;">
            <img src="/static/assets/images/image_971833.png" alt="Cleats">
            <h3>Nike Baseball Cleats</h3>
            <p>₹6,399</p>
        </a>
    </div>

  </div>
</section>

<footer>
  <p>© 2026 Sneaker Base. All Rights Reserved.</p>
  <a href="/api/v1/priority-access" style="display:none;">Admin API Access</a>
</footer>

<script src="{{ url_for('static', filename='js/script.js') }}"></script>
<script>
    function toggleHeart(btn, name, price, image) {
        // 1. Visual Change
        btn.classList.toggle("active");
        let icon = btn.querySelector("i");
        icon.style.color = btn.classList.contains("active") ? "red" : "#ccc";

        // 2. Send to Backend
        fetch('/api/toggle_wishlist', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ name: name, price: price, image: image })
        })
        .then(response => response.json())
        .then(data => {
            console.log("Wishlist count:", data.count);
        })
        .catch(error => console.error("Error:", error));
    }
</script>
</body>
</html>